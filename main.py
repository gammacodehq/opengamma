from model import invoke_func
import os
import logging
import argparse

parser = argparse.ArgumentParser()
parser.add_argument("--log", action="store_true", help="Enable logging")
args = parser.parse_args()

if args.log:
    logging.basicConfig(
        level=logging.INFO, format="%(asctime)s - %(levelname)s - %(message)s"
    )
log = logging.getLogger(__name__)


model = "openai/gpt-oss-20b:free"
model = "kwaipilot/kat-coder-pro:free"

# from datasets import load_dataset
# dataset = load_dataset("mikeoxmaul/opengamma-prs", streaming=True)
# first = dataset["train"].take(1)
# task = list(first)[0]["text"]
# log.info("Loaded task from dataset")

task = """
### –°–ª–∞–π–¥‚ÄØ1
**–ö–∞—Ä–∞–º–µ–ª—å–Ω—ã–π –†–∞—Ñ–∞ vs. –°–º—É–∑–∏ ‚Äì –í–≤–µ–¥–µ–Ω–∏–µ**

| –ß—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º | –ö–∞—Ä–∞–º–µ–ª—å–Ω—ã–π –†–∞—Ñ–∞ | –°–º—É–∑–∏ |
|----------------|------------------|-------|
| **–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã** | –ö–∞—Ä–∞–º–µ–ª—å, –º–æ–ª–æ–∫–æ/—Å–æ–µ–≤–æ–µ –º–æ–ª–æ–∫–æ, –≤–∞–Ω–∏–ª—å, –º–æ–ª–æ—á–Ω—ã–π/—Å–∞—Ö–∞—Ä–Ω—ã–π —Å–∏—Ä–æ–ø | –°–≤–µ–∂–∏–µ —Ñ—Ä—É–∫—Ç—ã, —è–≥–æ–¥—ã, –æ–≤–æ—â–∏, –π–æ–≥—É—Ä—Ç/–º–æ–ª–æ–∫–æ |
| **–ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ** | –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—ã–π –Ω–∞–ø–∏—Ç–æ–∫ –≤ –±—É—Ç—ã–ª–∫–µ/—Å—Ç–∞–∫–∞–Ω–µ | –ü–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —à–µ–π–∫–µ—Ä/–±–ª–µ–Ω–¥–µ—Ä, —Å–≤–µ–∂–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã  |
| **–í—Ä–µ–º—è** | 0‚ÄØ–º–∏–Ω—É—Ç ‚Äì –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å | 5‚Äì15‚ÄØ–º–∏–Ω—É—Ç (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ + –∏–∑–º–µ–ª—å—á–µ–Ω–∏–µ) |
| **–£–¥–æ–±—Å—Ç–≤–æ** | –ú–æ–∂–Ω–æ –ø–∏—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç, –±–µ–∑ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ | –ù—É–∂–Ω–æ –ø–æ–∫—É–ø–∞—Ç—å/–≥–æ—Ç–æ–≤–∏—Ç—å —Å–≤–µ–∂–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã |

*–ö–∞—Ä–∞–º–µ–ª—å–Ω—ã–π –†–∞—Ñ–∞ ‚Äì —ç—Ç–æ –±—ã—Å—Ç—Ä–æ—Ç–∞, —É–¥–æ–±—Å—Ç–≤–æ –∏ –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–π –≤–∫—É—Å, –∫–æ—Ç–æ—Ä—ã–π —Å—Ä–∞–∑—É –≥–æ—Ç–æ–≤ –∫ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—é.*

---

### –°–ª–∞–π–¥‚ÄØ2
**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ö–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –†–∞—Ñ–∞ –ø–µ—Ä–µ–¥ —Å–º—É–∑–∏**

1. **–ù–µ–ø—Ä–µ–≤–∑–æ–π–¥–µ–Ω–Ω—ã–π –≤–∫—É—Å**
   - –ë–æ–≥–∞—Ç–∞—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–∞—è –Ω–æ—Ç–∞ + –ª—ë–≥–∫–∞—è –≤–∞–Ω–∏–ª—å ‚Äì –Ω–∞—Å—Ç–æ—è—â–∏–π –¥–µ—Å–µ—Ä—Ç –≤ —Å—Ç–∞–∫–∞–Ω–µ.
   - –ù–µ—Ç ¬´–ø–æ—Å–ª–µ–≤–∫—É—à–∞¬ª –æ—Ç —Ñ—Ä—É–∫—Ç–æ–≤, —á—Ç–æ –±—ã–≤–∞–µ—Ç –ø—Ä–∏ —Å–º–µ—à–µ–Ω–∏–∏ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–∏—Ö –≤–∏–¥–æ–≤ —è–≥–æ–¥.

2. **–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –∑–∞—Ä—è–¥**
   - –°–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 35‚ÄØ–≥ —Å–∞—Ö–∞—Ä–∞ (‚âà140 –∫–∫–∞–ª) ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø–æ–¥–ø–∏—Ç–∫–∞.
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –∫–æ—Ñ–µ (–µ—Å–ª–∏ –µ—Å—Ç—å) + –∫–æ—Ñ–µ–∏–Ω + –∫–æ—Ñ–µ–∏–Ω‚Äë–ø—Ä–µ–≤–µ–Ω—Ü–∏—è ‚Äì –¥–≤–æ–π–Ω–æ–π –∞–Ω—Ç–∏‚Äë—É—Ç—Ä–µ–Ω–Ω–∏–π —ç—Ñ—Ñ–µ–∫—Ç.

3. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ —ç–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏**
   - 0‚ÄØ–º–∏–Ω—É—Ç –Ω–∞ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ, –º–æ–∂–Ω–æ –≤–∑—è—Ç—å ¬´—Å —Å–æ–±–æ–π¬ª –¥–∞–∂–µ –≤ –ø–æ–µ–∑–¥–∫—É.
   - –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∞—Ç—å —Ñ—Ä—É–∫—Ç—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äì –æ–¥–Ω–∞ –±—É—Ç—ã–ª–∫–∞ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —Å–ø—Ä–æ—Å.

4. **–î–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**
   - –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞, –±–µ–∑ ¬´–ø—è—Ç–µ–Ω¬ª –∏ ¬´—Å–ª–æ–π–∫–æ–≤¬ª ‚Äì –≤—Å–µ–≥–¥–∞ —Ä–æ–≤–Ω—ã–π –≤–∫—É—Å.
   - –§—Ä—É–∫—Ç—ã –≤ —Å–º—É–∑–∏ —á–∞—Å—Ç–æ —Ä–∞–∑—Ä—É—à–∞—é—Ç—Å—è –∏ –¥–∞—é—Ç –∫—Ä–æ—à–∫–∏, –Ω–∞—Ä—É—à–∞—è –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ.

5. **–°–∫–æ—Ä–æ—Å—Ç—å —É—Å–≤–æ–µ–Ω–∏—è**
   - –û—á–∏—â—ë–Ω–Ω—ã–π –æ—Ç –∫–ª–µ—Ç—á–∞—Ç–∫–∏ —Å–ª–∞–±–æ –æ—Å—É—à—ë–Ω–Ω—ã–π —Å–∞—Ö–∞—Ä –±—ã—Å—Ç—Ä–æ –≤—Å–∞—Å—ã–≤–∞–µ—Ç—Å—è, –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–≤—ã—à–∞—è —É—Ä–æ–≤–µ–Ω—å glucose.
   - –í —Å–º—É–∑–∏ –∫–ª–µ—Ç—á–∞—Ç–∫–∞ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Å–∞—Ö–∞—Ä–∞ –Ω–∞ 1‚Äì2‚ÄØ—á.

---

### –°–ª–∞–π–¥‚ÄØ3
**–ò—Ç–æ–≥–æ–≤–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ ‚Äì –ø–æ—á–µ–º—É –≤—ã–±—Ä–∞—Ç—å –ö–∞—Ä–∞–º–µ–ª—å–Ω—ã–π –†–∞—Ñ–∞**

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –ö–∞—Ä–∞–º–µ–ª—å–Ω—ã–π –†–∞—Ñ–∞ | –°–º—É–∑–∏ |
|------------|------------------|-------|
| **–í–∫—É—Å** | 9/10 ‚Äì —Å–ª–∞–¥–∫–æ-–∫–∞—Ä–∞–º–µ–ª—å–Ω—ã–π | 7/10 ‚Äì —Ñ—Ä—É–∫—Ç–æ–≤—ã–π, –∏–Ω–æ–≥–¥–∞ ¬´—Å—É—Ö–æ–π¬ª |
| **–í—Ä–µ–º—è –Ω–∞ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ** | 0‚ÄØ–º–∏–Ω—É—Ç | 5‚Äì15‚ÄØ–º–∏–Ω—É—Ç |
| **–ù–∞–ª–∏—á–∏–µ —Å–∞—Ö–∞—Ä–∞** | 35‚ÄØ–≥ + –∫–æ—Ñ–µ–∏–Ω | 15‚Äì25‚ÄØ–≥ + –∫–ª–µ—Ç—á–∞—Ç–∫–∞ |
| **–£–¥–æ–±—Å—Ç–≤–æ** | –ü–µ—Ä–µ–Ω–æ—Å–Ω–æ–π, –±–µ–∑ –º—É—Å–æ—Ä–∞ | –¢—Ä–µ–±—É–µ—Ç —Å–≤–µ–∂–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –±–ª–µ–Ω–¥–µ—Ä |
| **–ë—ã—Å—Ç—Ä—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç** | ‚úî | ‚úî (–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –∫–ª–µ—Ç—á–∞—Ç–∫–∏ ‚Äì –º–µ–¥–ª–µ–Ω–Ω–æ) |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å (–Ω–∞ 1 —á–∞—à–∫—É)** | 10‚Äì15‚ÄØ—Ä | 30‚Äì70‚ÄØ—Ä (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ—Ä—É–∫—Ç–æ–≤) |

**–í—ã–≤–æ–¥**:
*–ö–∞—Ä–∞–º–µ–ª—å–Ω—ã–π –†–∞—Ñ–∞ ‚Äì –∏–¥–µ–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ü–µ–Ω–∏—Ç –±—ã—Å—Ç—Ä—ã–π, –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–π –≤–∫—É—Å –∏ —É–¥–æ–±—Å—Ç–≤–æ –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Ö–ª–æ–ø–æ—Ç. –°–º—É–∑–∏ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ü–µ–Ω–∏—Ç—Å—è –∑–∞ —Å–≤–µ–∂–µ—Å—Ç—å –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∫–ª–µ—Ç—á–∞—Ç–∫–∏, –Ω–æ –¥–ª—è ¬´–±—ã—Å—Ç—Ä–æ–≥–æ¬ª —É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∑–∞—Ä—è–¥–∞ –∏–º–µ–Ω–Ω–æ –†–∞—Ñ–∞ –±—É–¥–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º.*

---

üí° *–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –Ω–∞ —Å–ª–∞–π–¥–∞—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:*

1. **–°–ª–∞–π–¥‚ÄØ1** ‚Äì –±–æ–∫–∞–ª —Å –∫–∞—Ä–∞–º–µ–ª—å–Ω—ã–º –†–∞—Ñ–∞ —Ä—è–¥–æ–º —Å –±–ª–µ–Ω–¥–µ—Ä–æ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º —Å–æ–±—Ä–∞–Ω —Å–º—É–∑–∏.
2. **–°–ª–∞–π–¥‚ÄØ2** ‚Äì –∏–∫–æ–Ω–∫–∏ –ø–ª—é—Å–æ–≤: –≤–∫—É—Å, –∫–æ—Ñ–µ, –≤—Ä–µ–º—è, —Ü–µ–Ω–∞.
3. **–°–ª–∞–π–¥‚ÄØ3** ‚Äì —Ç–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –∫—Ä–∞—Å–Ω—ã–º–∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏ –Ω–∞ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –†–∞—Ñ–∞.

*–£–¥–∞—á–Ω–æ–π –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏!*
"""

system_prompt = f"""
Write a complete Python script using the python-pptx library to create a PowerPoint presentation (PPTX).
The script must:
- Use appropriate slide layouts (e.g., title slide, bullet slide).
- Save the presentation to a file named 'test.pptx'.
Output ONLY the Python code as plain text, without markdown, code block markers (e.g., ` + "```" + `python)

Example:
from pptx import Presentation
from pptx.util import Inches

prs = Presentation()
title_slide_layout = prs.slide_layouts[0]
slide = prs.slides.add_slide(title_slide_layout)
title = slide.shapes.title
subtitle = slide.placeholders[1]

title.text = "Hello, World!"
subtitle.text = "python-pptx was here!"

title_only_slide_layout = prs.slide_layouts[5]
slide = prs.slides.add_slide(title_only_slide_layout)
shapes = slide.shapes

shapes.title.text = 'Adding a Table'

rows = cols = 2
left = top = Inches(2.0)
width = Inches(6.0)
height = Inches(0.8)

table = shapes.add_table(rows, cols, left, top, width, height).table

# set column widths
table.columns[0].width = Inches(2.0)
table.columns[1].width = Inches(4.0)

# write column headings
table.cell(0, 0).text = 'Foo'
table.cell(0, 1).text = 'Bar'

# write body cells
table.cell(1, 0).text = 'Baz'
table.cell(1, 1).text = 'Qux'


bullet_slide_layout = prs.slide_layouts[1]

slide = prs.slides.add_slide(bullet_slide_layout)
shapes = slide.shapes

title_shape = shapes.title
body_shape = shapes.placeholders[1]

title_shape.text = 'Adding a Bullet Slide'

tf = body_shape.text_frame
tf.text = 'Find the bullet slide layout'

p = tf.add_paragraph()
p.text = 'Use _TextFrame.text for first bullet'
p.level = 1

p = tf.add_paragraph()
p.text = 'Use _TextFrame.add_paragraph() for subsequent bullets'
p.level = 2

prs.save('test.pptx')"""

if __name__ == "__main__":
    result, _ = invoke_func(model, system_prompt, task, "1")
    if result == 1:
        print("Success")
    else:
        print("Failed")
